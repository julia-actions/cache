name: 'Cache Julia Artifacts'
description: 'Cache Julia artifacts using actions/cache'
author:
  - 'Sascha Mann'
  - 'Rik Huijzer'

branding:
  icon: 'archive'
  color: 'purple'

inputs:
  cache-name:
    description: 'Name used as part of the cache keys'
    default: 'cache-artifacts'

outputs:
  cache-hit:
    description: 'A boolean value to indicate an exact match was found for the primary key. Forwarded from actions/cache'

runs:
  using: 'composite'
  steps:
    # actions/cache@v1.0.7
    - uses: actions/cache@1a9e2138d905efd099035b49d8b7a3888c653ca8
      id: cache
      with:
        path: ~/.julia/artifacts
        key: ${{ runner.os }}-test-${{ inputs.cache-name }}-${{ hashFiles('**/Project.toml') }}
        restore-keys: |
          ${{ runner.os }}-test-${{ inputs.cache-name }}-

    - run: |
        echo "Setting outputs.cache-hit to \"$CACHE_HIT\""
        echo "::set-output name=cache-hit::$CACHE_HIT"
      env:
        CACHE_HIT: ${{ steps.cache.outputs.cache-hit }}
      shell: bash
